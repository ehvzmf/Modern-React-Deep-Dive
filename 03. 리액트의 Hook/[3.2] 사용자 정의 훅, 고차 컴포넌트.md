<aside>
ğŸ³

ì¬ì‚¬ìš© ë¡œì§ì„ ì‘ì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë‘ ê°€ì§€ ë°©ì‹: custom hook, higher order component

</aside>

# ì‚¬ìš©ì ì •ì˜ í›…

---

- ë¦¬ì•¡íŠ¸ í›…ì„ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œìê°€ í•„ìš”í•œ í›…ì„ ë§Œë“œëŠ” ê¸°ë²•
- ì„œë¡œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ê°™ì€ ë¡œì§ì„ ê³µìœ í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©
- ë¦¬ì•¡íŠ¸ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥
- ì´ë¦„ì´ ë°˜ë“œì‹œ `use`ë¡œ ì‹œì‘ (ê°œë°œ ì‹œ ì¸ì‹ ê°€ëŠ¥, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ ë°œìƒ)
    - ë‚´ë¶€ì—ì„œ `useState`ì™€ ê°™ì€ ë¦¬ì•¡íŠ¸ í›…ì„ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ë¦¬ì•¡íŠ¸ í›…ì˜ ê·œì¹™ ì¤€ìˆ˜
    - `react-hooks/rules-of-hooks` â†’ í›…ì€ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸/ì‚¬ìš©ì ì •ì˜ í›… ë‚´ë¶€ì—ë§Œ ì‚¬ìš© ê°€ëŠ¥
    - ESLintì˜ ì •ì  ë¶„ì„ì„ ìœ„í•´ì„œ useë¡œ ì‹œì‘ í•„ìˆ˜ https://github.com/facebook/react/blob/main/packages/eslint-plugin-react-hooks/src/RulesOfHooks.js
    - use-Hooks, react-use, ahooks ë“±ì˜ ì €ì¥ì†Œ ì°¸ê³  https://usehooks.com/
- ex) fetch ê¸°ë°˜ ì‚¬ìš©ì ì •ì˜ í›…
    
    ```jsx
    import { useEffect, useState } from 'react'
    
    function useFetch<T>(
        url: string,
        { method, body }: { method: string; body?: XMLHttpRequestBodyInit },
    ) {
        const [result, setResult] = useState<T | undefined>()
        const [isLoading, setIsLoading] = useState<boolean>(false)
        const [ok, setOk] = useState<boolean | undefined>()
        const [status, setStatus] = useState<number | undefined>()
    
        useEffect(() => {
            const abortController = new AbortController()
    
            ;(async () => {
                setIsLoading (true)
    
                const response = await fetch(url, {
                    method, 
                    body,
                    signal: abortController.signal,
                })
    
                setOk(response.ok)
                setStatus(response.status)
    
                if (response.ok) {
                    const apiResult = await response.json()
                    setResult(apiResult)
                }
    
                setIsLoading(false)
            })()
    
            return () => {
                abortController.abort()
            }
        }, [url, method, body])
    
        return { ok, result, isLoading, status }
    }
    
    interface Todo {
        userId: number
        id: number
        title: string
        completed: boolean
    }
    
    export default function App() {
        const { isLoading, result, status, ok } = useFetch<Array<Todo>>(
            'https://example.com/todos',
            {
                method: 'GET',
            },
        )
    
        useEffect(() => {
            if (!isLoading) {
                console.log('fetchResult >>', status)
            }
        }, [status, isLoading])
    
        return (
            <div>
                {ok
                ? (result || []).map(({ userId, title }, index) => (
                    <div key={index}>
                        <p>{userId}</p>
                        <p>{title}</p>
                    </div>
                )) : null}
            </div>
        )
    }
    ```
    

# ê³ ì°¨ ì»´í¬ë„ŒíŠ¸

---

- HOC, Higher Order Component â†’ ì»´í¬ë„ŒíŠ¸ ìì²´ì˜ ë¡œì§ì„ ì¬ì‚¬ìš©
- ê³ ì°¨ í•¨ìˆ˜ì˜ ì¼ì¢…ìœ¼ë¡œ, ìë°”ìŠ¤í¬ë¦½íŠ¸ í™˜ê²½ì—ì„œ ì‚¬ìš© ê°€ëŠ¥
- ë‹¤ì–‘í•œ ìµœì í™”, ì¤‘ë³µ ë¡œì§ ê´€ë¦¬ ê°€ëŠ¥

### React.memo

> ê°€ì¥ ìœ ëª…í•œ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸
ë¦¬ì•¡íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” API
> 
- ChildëŠ” props ë³€ê²½ì— ê´€ê³„ì—†ì´ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë”ë§ ì‹œ ë¬´ì¡°ê±´ ë¦¬ë Œë”ë§
- props ë³€í™” ì—†ì„ ë•ŒëŠ” ë Œë”ë§ ë°©ì§€í•˜ë„ë¡ ë§Œë“¤ì–´ì§„ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ React.memo
    - code
        
        ```jsx
        const ChildComponent = memo({ value }: { value: string }) => {
            useEffect(() => {
                console.log('render!');
            })
        
            return <>Hi! {value}</>
        }
        
        function ParentComponent() {
            const [state, setState] = useState(1)
        
            function handleChange(e: ChangeEvent<HTMLInputElement>) {
                setState(Number(e.target.value))
            }
        
            return (
                <>
                    <input type="number" value={state} onChange={handleChange} />
                    <ChildComponent value="hello" />
                </>
            )
        }
        ```
        
- ë Œë”ë§ ì „ props ë¹„êµ í›„ ê°™ë‹¤ë©´ ë Œë”ë§ ìƒëµ, memoization ì»´í¬ë„ŒíŠ¸ ë°˜í™˜
    - ë¶ˆí•„ìš”í•œ ë Œë”ë§ ìƒëµ (PureComponentì™€ ìœ ì‚¬)
- useMemoë¥¼ ì‚¬ìš©í•  ê²½ìš° ê°’ì„ ë°˜í™˜ë°›ê¸° ë•Œë¬¸ì— `< />`ê°€ ì•„ë‹Œ `{}` ì‚¬ìš©
    - `<ChildComponent />`ê°€ ì•„ë‹ˆë¼ `{MemoizedChildComponent}`
    - ì½”ë“œ ì‘ì„±/ë¦¬ë·°í•˜ëŠ” ì…ì¥ì—ì„œ í˜¼ì„ ì„ ë¹šì„ ìˆ˜ ìˆì–´ ëª©ì ê³¼ ìš©ë„ê°€ ëšœë ·í•œ memo ê¶Œì¥

### ê³ ì°¨ í•¨ìˆ˜ ë§Œë“¤ê¸°

> í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ë°›ê±°ë‚˜ ê²°ê³¼ë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
> 

- `Array.prototype.map`ì´ ê°€ì¥ ëŒ€í‘œì 
    
    ```jsx
    const list = [1, 2, 3]
    const doubledList = list.map((item) => item * 2)
    ```
    
    `(item) => item * 2)` í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ë°›ê³  ìˆë‹¤. 
    
- `forEach`, `reduce` ë“±ë„ ê³ ì°¨ í•¨ìˆ˜
- `setState` â†’ useStateì—ì„œ ë°˜í™˜ëœ ë‘ ë²ˆì§¸ ë°°ì—´ ê°’ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ í•¨ìˆ˜ ë°˜í™˜
    
    ```jsx
    const setState = (function () {
    	// í˜„ì¬ indexë¥¼ í´ë¡œì €ë¡œ ê°€ë‘¬ë†”ì„œ ì´í›„ì—ë„ ê³„ì† ë™ì¼í•œ ì¸ë±ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤. 
    	let currentIndex = index
    	return function (value) {
    		global.states[currentIndex] = value
    		// component rendering . . .
    	}
    })()
    ```
    

```jsx
function add(a) {
	return function (b) {
		return a + b
	}
}

const result = add(1) // resultëŠ” ì•ì„œ ë°˜í™˜í•œ í•¨ìˆ˜
const result2 = result(2) // a + b, 3 ë°˜í™˜
```

- `useState`ì˜ ì›ë¦¬ì™€ ìœ ì‚¬
    - `useState`ì‹¤í–‰ì€ í•¨ìˆ˜ í˜¸ì¶œê³¼ ë™ì‹œì— ë
    - state ê°’ì€ í´ë¡œì €ì— ê¸°ì–µ â†’ a=1 ì •ë³´ê°€ ë‹´ê¸´ í´ë¡œì €ê°€ resultì— í¬í•¨
    - result(2) í˜¸ì¶œë¡œ í´ë¡œì €ì— ë‹´ê¸´ a=1ì„ í™œìš©í•´ ê²°ê³¼ ë°˜í™˜

### ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

- ì‚¬ìš©ì ì¸ì¦ ì‹œ ê°œì¸í™”ëœ ì»´í¬ë„ŒíŠ¸, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ê³µí†µ ì»´í¬ë„ŒíŠ¸ ë³´ì—¬ì£¼ê¸°
    - code
        
        ```tsx
        interface LoginProps {
            loginRequired?: boolean
        }
        
        function withLoginComponent<T>(Component: ComponentType<T>) {
            return function (props: T & LoginProps) {
                const { loginRequired, ...restProps } = props
        
                if (loginRequired) {
                    return <>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</>
                }
        
                return <Component {...(restProps as T)} />
            }
        }
        
        const Component = withLoginComponent((props: { value: string }) => {
            return <h3>{props.value}</h3>
        })
        
        export default function App() {
            const isLogin = true
            return <Component value="text" loginRequired={isLogin} />
            // return <Component value="text" />;
        }
        ```
        
        - ì›ë˜ êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ `withLoginComponent`ë¡œ ê°ì‹¸ê¸°ë§Œ í•˜ë©´ ë
            - `withLoginComponent`ëŠ” í•¨ìˆ˜(ì»´í¬ë„ŒíŠ¸) ìì²´ë¥¼ ì¸ìˆ˜ë¡œ ë°›ê³ , ì»´í¬ë„ŒíŠ¸ë¥¼ ë°˜í™˜í•œë‹¤.
        - ë¡œê·¸ì¸ ì±…ì„ì€ ëª¨ë‘ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ì— ë§¡ê¸¸ ìˆ˜ ìˆë‹¤.
- ì»´í¬ë„ŒíŠ¸ ì „ì²´ë¥¼ ê°ìŒ€ ìˆ˜ ìˆì–´ ì»¤ìŠ¤í…€ í›…ë³´ë‹¤ ë”ìš± í° ì˜í–¥ë ¥
- ì»¤ìŠ¤í…€ í›…ì€ ê°’ ë°˜í™˜/ë¶€ìˆ˜íš¨ê³¼ ì‹¤í–‰, ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ëŠ” ì»´í¬ë„ŒíŠ¸ ê²°ê³¼ë¬¼ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ê³µí†µ ì‘ì—… ì²˜ë¦¬ ê°€ëŠ¥
- ì´ë¦„ì€ `with` ìœ¼ë¡œ ì‹œì‘í•´ì•¼ í•œë‹¤.
    - ESLint ê·œì¹™ìœ¼ë¡œ ê°•ì œë˜ëŠ” ê±´ ì•„ë‹ˆì§€ë§Œ withRouter ê°™ì€ ì¼ì¢…ì˜ ê´€ìŠµ
- ë¶€ìˆ˜ íš¨ê³¼ë¥¼ ìµœì†Œí™”í•  ê²ƒ
    - ë°˜ë“œì‹œ ì»´í¬ë„ŒíŠ¸ì˜ propsë¥¼ ì„ì˜ë¡œ ìˆ˜ì •, ì¶”ê°€, ì‚­ì œí•˜ì§€ ë§ì•„ì•¼ í•œë‹¤.
    - ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ ì–¸ì œ propsê°€ ìˆ˜ì •ë ì§€ ëª¨ë¥´ëŠ” ìš°ë ¤ ë°œìƒ
    - ì¶”ê°€ ì •ë³´ë¥¼ ì œê³µí•´ì¤˜ì•¼ í•œë‹¤ë©´ ë³„ë„ propsë¡œ ë‚´ë ¤ì£¼ëŠ” ê²Œ ì¢‹ë‹¤.
- ì—¬ëŸ¬ ê°œì˜ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ë¡œ ê°ì‹¸ì§€ ë§ì.

# ë¬´ì—‡ì„ ì„ íƒ?

---

ë‘˜ ë‹¤ ì–´ë– í•œ ë¡œì§ì„ ê³µí†µí™”í•´ ë³„ë„ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. 

â†’ ì»´í¬ë„ŒíŠ¸ í¬ê¸°ëŠ” ì¤„ì´ê³  ê°€ë…ì„±ì€ í–¥ìƒëœë‹¤. ë‘˜ ì¤‘ì— ë­˜ ì‚¬ìš©í• ê¹Œ?

## 1. ì‚¬ìš©ì ì •ì˜ í›…ì´ í•„ìš”í•œ ê²½ìš°

ë‹¨ìˆœíˆ useEffect, useState ë“± ë¦¬ì•¡íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” í›…ìœ¼ë¡œë§Œ ê³µí†µ ë¡œì§ì„ ê²©ë¦¬í•  ìˆ˜ ìˆì„ ë•Œ

- ì»¤ìŠ¤í…€ í›…ì€ ê·¸ ìì²´ë¡œëŠ” ë Œë”ë§ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šì•„ ì œí•œì 
- ë°˜í™˜í•˜ëŠ” ê°’ì„ ë°”íƒ•ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ìµœì†Œí™”í•´ ì›í•˜ëŠ” ë°©í–¥ìœ¼ë¡œë§Œ ì‚¬ìš© ê°€ëŠ¥

```jsx
function HookComponent() {
    const { loggedIn } = useLogin()

    useEffect(() => {
        if (!loggedIn) {
            // do something
        }
    }, [loggedIn]) 
}
```

```jsx
const HOCComponent = withLoginComponent(() => {
    //do something
})
```

- `useLogin` ì€ ë‹¨ìˆœíˆ `loggedIn` ì— ëŒ€í•œ ê°’ë§Œ ì œê³µ, ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ ì›í•˜ëŠ”ëŒ€ë¡œ ì²˜ë¦¬
- `withLoginComponent`ëŠ” ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ì˜ ì‘ì—…ê³¼ ë°˜í™˜ì„ ì§ì ‘ ë³´ê±°ë‚˜ ì‹¤í–‰í•˜ê¸° ì „ê¹Œì§€ ì•Œ ìˆ˜ ì—†ë‹¤.
    - ëŒ€ê°œ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ëŠ” ë Œë”ë§ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ë¡œì§ì´ ì¡´ì¬, ì˜ˆì¸¡ì´ ì–´ë µë‹¤.
- ë‹¨ìˆœíˆ ë™ì¼í•œ ë¡œì§ìœ¼ë¡œ ê°’ì„ ì œê³µí•˜ê±°ë‚˜ íŠ¹ì • í›…ì˜ ì‘ë™ì„ ì·¨í•˜ê²Œ í•˜ê³  ì‹¶ì„ ê²½ìš° ì‚¬ìš©

## 2. ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ê°€ í•„ìš”í•œ ê²½ìš°

í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì˜ ë°˜í™˜ê°’, ì¦‰ ë Œë”ë§ ê²°ê³¼ë¬¼ê¹Œì§€ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê³µí†µ ë¡œì§ì´ë¼ë©´ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©

- ë¡œê·¸ì¸ì„ ìš”êµ¬í•˜ëŠ” ê³µí†µ ì»´í¬ë„ŒíŠ¸ ë…¸ì¶œ
- ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì™€ ë¹„ìŠ·í•˜ê²Œ íŠ¹ì • ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ì—ëŸ¬ ì²˜ë¦¬ ì»´í¬ë„ŒíŠ¸ ë…¸ì¶œ

```jsx
function HookComponent() {
	const { loggedIn } = useLogin()
	
	if (!loggedIn) {
		return <LoginComponent />
	}
	
	return <>hi.</>
}

const HOCComponent = withLoginComponent(() => {
	// loggedIn state ê°’ì€ ì‹ ê²½ì“°ì§€ ì•Šê³  ì»´í¬ë„ŒíŠ¸ì— í•„ìš”í•œ ë¡œì§ë§Œ ì¶”ê°€
	// loggedIn stateì— ë”°ë¥¸ ì œì–´ëŠ” ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ
	return <>hi.</>
})
```

- loggedInì´ falseì¸ ê²½ìš° ë Œë”ë§í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ë™ì¼, ì»¤ìŠ¤í…€ í›…ë§Œìœ¼ë¡œ í‘œí˜„í•˜ê¸° ì–´ë µë‹¤.
    - í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ê°€ ë°˜í™˜í•˜ëŠ” ë Œë”ë§ ê²°ê³¼ë¬¼ê¹Œì§€ ì˜í–¥ì„ ë¯¸ì¹˜ê¸°ëŠ” ì–´ë µê¸° ë•Œë¬¸ì—
    - ì¤‘ë³µ ì²˜ë¦¬ê°€ ì»¤ìŠ¤í…€ í›…ì„ ì‚¬ìš©í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì— ë‚˜íƒ€ë‚  ê²ƒ
